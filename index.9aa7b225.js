!function(){var e={};function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var n={},a=(n={getRandomIndex:function(e){return Math.floor(Math.random()*e)},createFreeNumber:function(e,t){return .9>Math.random()?e:t}}).getRandomIndex,l=n.createFreeNumber;e=function(){var e,n;function o(e){if(!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),this.state=[],e)this.state=e;else for(var t=0;t<4;t++)this.state.push([,,,,].fill(0));this.status="idle",this.score=0,this.initialState=JSON.parse(JSON.stringify(this.state))}return e=[{key:"getState",value:function(){return this.state}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status="playing";for(var e=0;e<2;e++)o.fillRandomCell(this.state)}},{key:"restart",value:function(){this.state=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}},{key:"moveRight",value:function(){if("playing"===this.status){var e=this.state,t=JSON.parse(JSON.stringify(e));o.moveFilledCellsRight(e);for(var r=0;r<e.length;r++)for(var n=e[r],a=n.length-1;a>0;a--)n[a]===n[a-1]&&0!==n[a]&&(n[a-1]=0,n[a]*=2,this.score+=n[a]);o.moveFilledCellsRight(e),o.checkAfterMove(this,t,e)}}},{key:"moveLeft",value:function(){if("playing"===this.status){var e=this.state,t=JSON.parse(JSON.stringify(e));o.moveFilledCellsLeft(e);for(var r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length-1;a++)n[a]===n[a+1]&&0!==n[a]&&(n[a]*=2,n[a+1]=0,this.score+=n[a]);o.moveFilledCellsLeft(e),o.checkAfterMove(this,t,e)}}},{key:"moveDown",value:function(){if("playing"===this.status){var e=this.state,t=JSON.parse(JSON.stringify(e));o.moveFilledCellsDown(e);for(var r=0;r<e.length;r++)for(var n=e[r].length-1;n>0;n--)e[n][r]===e[n-1][r]&&0!==e[n][r]&&(e[n][r]*=2,e[n-1][r]=0,this.score+=e[n][r]);o.moveFilledCellsDown(e),o.checkAfterMove(this,t,e)}}},{key:"moveUp",value:function(){if("playing"===this.status){var e=this.state,t=JSON.parse(JSON.stringify(e));o.moveFilledCellsUp(e);for(var r=0;r<e.length;r++)for(var n=0;n<e[r].length-1;n++)e[n][r]===e[n+1][r]&&0!==e[n][r]&&(e[n][r]*=2,e[n+1][r]=0,this.score+=e[n][r]);o.moveFilledCellsUp(e),o.checkAfterMove(this,t,e)}}}],n=[{key:"getFreeCells",value:function(e){for(var t=[],r=0;r<e.length;r++)!function(r){var n=e[r];if(n.some(function(e){return 0===e}))for(var a=0;a<n.length;a++)0===n[a]&&t.push([r,a])}(r);return t}},{key:"fillRandomCell",value:function(e){var t=o.getFreeCells(e),n=t.length;if(0!==n){var s,i=function(e){if(Array.isArray(e))return e}(s=t[a(n)])||function(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var l=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(r=a.next()).done)&&(l.push(r.value),2!==l.length);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw n}}return l}}(s,2)||function(e,t){if(e){if("string"==typeof e)return r(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,2)}}(s,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),c=i[0],u=i[1];e[c][u]=l(2,4)}}},{key:"moveFilledCellsRight",value:function(e){e.forEach(function(t,r){var n=t.filter(function(e){return 0!==e}),a=Array(t.length-n.length).fill(0);e[r]=a.concat(n)})}},{key:"moveFilledCellsLeft",value:function(e){e.forEach(function(t,r){var n=t.filter(function(e){return 0!==e}),a=Array(t.length-n.length).fill(0);e[r]=n.concat(a)})}},{key:"moveFilledCellsDown",value:function(e){for(var t=0;t<e.length;t++){for(var r=[],n=[],a=0;a<e[t].length;a++)0===e[a][t]?n.push(e[a][t]):r.push(e[a][t]);var l=n.concat(r);if(n.length)for(var o=0;o<e[t].length;o++)e[o][t]=l[o]}}},{key:"moveFilledCellsUp",value:function(e){for(var t=0;t<e.length;t++){for(var r=[],n=[],a=0;a<e[t].length;a++)0===e[a][t]?n.push(e[a][t]):r.push(e[a][t]);var l=r.concat(n);if(n.length)for(var o=0;o<e[t].length;o++)e[o][t]=l[o]}}},{key:"canMove",value:function(e){for(var t=0;t<e.length;t++)for(var r=e[t],n=0;n<r.length-1;n++)if(r[n]===r[n+1]||e[n][t]===e[n+1][t])return!0;return!1}},{key:"isstateChanged",value:function(e,t){var r=!1;return e.forEach(function(e,n){e.every(function(e,r){return t[n][r]===e})||(r=!0)}),r}},{key:"checkStatus",value:function(e){var t=e.state;t.forEach(function(t){t.some(function(e){return 2048===e})&&(e.status="win")});var r=o.getFreeCells(t);o.canMove(t)||0!==r.length||(e.status="lose")}},{key:"checkAfterMove",value:function(e,t,r){o.isstateChanged(t,r)&&o.fillRandomCell(r),o.checkStatus(e)}}],e&&t(o.prototype,e),n&&t(o,n),o}();var o=document.querySelector(".button"),s=document.querySelector(".message-start"),i=document.querySelector(".message-win"),c=document.querySelector(".message-lose"),u=document.querySelector(".game-score"),f=new e;v();var h=function(e){switch(e.code){case"ArrowLeft":f.moveLeft();break;case"ArrowRight":f.moveRight();break;case"ArrowDown":f.moveDown();break;case"ArrowUp":f.moveUp();break;default:return}d()};function v(){for(var e=document.querySelector(".game-field").rows,t=f.state,r=0;r<t.length;r++)for(var n=t[r],a=0;a<n.length;a++)if(n[a]){var l=e[r].cells[a],o=n[a];l.textContent=o,l.className="field-cell field-cell--".concat(o)}else e[r].cells[a].textContent="",e[r].cells[a].className="field-cell"}function d(){v(),u.textContent=f.score,function(){switch(f.status){case"win":i.classList.remove("hidden"),document.removeEventListener("keydown",h);break;case"lose":c.classList.remove("hidden");break;default:c.classList.add("hidden"),i.classList.add("hidden")}}()}o.addEventListener("click",function(){o.classList.contains("start")?(f.start(),d(),s.classList.add("hidden"),document.addEventListener("keydown",h)):(f.restart(),d(),s.classList.remove("hidden"),document.removeEventListener("keydown",h)),o.classList.toggle("start"),o.classList.toggle("restart"),o.textContent=o.classList.contains("start")?"Start":"Restart"})}();
//# sourceMappingURL=index.9aa7b225.js.map
